<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VivaSmart - Home</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <link rel="stylesheet" href="assets/css/style.css" />
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand" href="#">VivaSmart</a>
      <div class="ms-auto d-flex align-items-center gap-3">
        <span id="userName" class="text-white fw-bold"></span>
        <span id="userEmail" class="text-white"></span>
        <button id="logoutBtn" class="btn btn-danger btn-sm" style="display: none;">Logout</button>
        <a href="cart.html" class="text-white">
          <i class="fas fa-shopping-cart"></i> Cart (<span id="cart-count">0</span>)
        </a>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero text-center text-white p-5 bg-primary">
    <h1>Welcome to VivaSmart</h1>
    <p>Get amazing deals on gadgets, fashion, and more!</p>
    <a href="#products" class="btn btn-light mt-3">Start Shopping</a>
  </section>

  <!-- Categories -->
  <div class="container category-scroll mt-4">
    <span class="badge rounded-pill bg-primary">All</span>
    <span class="badge rounded-pill bg-secondary">Phones</span>
    <span class="badge rounded-pill bg-secondary">Fashion</span>
    <span class="badge rounded-pill bg-secondary">Electronics</span>
    <span class="badge rounded-pill bg-secondary">Groceries</span>
    <span class="badge rounded-pill bg-secondary">Appliances</span>
    <span class="badge rounded-pill bg-secondary">Computers</span>
    <span class="badge rounded-pill bg-secondary">Toys</span>
  </div>

  <!-- Product Grid -->
  <div class="container my-5" id="products">
    <h3 class="mb-4">Featured Products</h3>
    <div class="row" id="product-list">
      <!-- JavaScript will insert product cards here -->
    </div>
  </div>

  <!-- Firebase Auth Script -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";

    // Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyBw5DaGdr-8Ibon6sRhJMb3bAIWMgz4w-8",
      authDomain: "vivasmart-4588f.firebaseapp.com",
      projectId: "vivasmart-4588f",
      storageBucket: "vivasmart-4588f.firebasestorage.app",
      messagingSenderId: "815227488896",
      appId: "1:815227488896:web:005f22c99d90d5168cb465",
      measurementId: "G-3NNSR3J1Y5"
    };

    // Init Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    const logoutBtn = document.getElementById("logoutBtn");
    const userNameEl = document.getElementById("userName");
    const userEmailEl = document.getElementById("userEmail");

    // Check login status
    onAuthStateChanged(auth, (user) => {
      if (user) {
        userNameEl.textContent = user.displayName ? `Hi, ${user.displayName}` : "Hi, User";
        userEmailEl.textContent = `(${user.email})`;
        logoutBtn.style.display = "inline-block";
      } else {
        userNameEl.textContent = "";
        userEmailEl.textContent = "";
        logoutBtn.style.display = "none";
        window.location.href = "login.html";
      }
    });

    // Logout
    logoutBtn.addEventListener("click", () => {
      signOut(auth).then(() => {
        window.location.href = "login.html";
      });
    });

    // Product List
    const products = [
      { id: 1, name: "Wireless Earbuds", price: 9500, image: "./assets/images/wireless earbuds.jpg" },
      { id: 2, name: "Smart Watch", price: 15500, image: "./assets/images/smartwatch01.jpg" },
      { id: 3, name: "Android Phone", price: 74500, image: "./assets/images/Android Phone04.jpg" },
      { id: 4, name: "Laptop", price: 175000, image: "./assets/images/laptop01.jpg" },
      { id: 5, name: "Blender", price: 8500, image: "./assets/images/blender01.jpg" },
      { id: 6, name: "Running Shoes", price: 12500, image: "./assets/images/shoes01.jpg" }
    ];

    const productList = document.getElementById("product-list");

    products.forEach(product => {
      const col = document.createElement("div");
      col.className = "col-md-4 col-sm-6 mb-4";
      col.innerHTML = `
        <div class="card product-card h-100">
          <img src="${product.image}" class="product-img" alt="${product.name}">
          <div class="product-info p-3">
            <h5>${product.name}</h5>
            <p class="price">â‚¦${product.price.toLocaleString()}</p>
            <a href="product-details-${product.id}.html" class="btn btn-sm btn-primary w-100">
              <i class="fas fa-eye"></i> View Details
            </a>
          </div>
        </div>
      `;
      productList.appendChild(col);
    });

        // Update Cart Count (sum of all product quantities)
    function updateCartCount() {
      const cart = JSON.parse(localStorage.getItem("cart")) || [];
      const totalQty = cart.reduce((sum, item) => sum + (item.quantity || 1), 0);
      document.getElementById("cart-count").textContent = totalQty;
    }
    updateCartCount();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
